database:
  info:
    ######################################### MySQL数据库 #############################################
    mysql:
      driverClass: com.mysql.cj.jdbc.Driver

      url: jdbc:mysql://@${ip}:${port}/${database}?serverTimezone=Asia/Shanghai&useUnicode=true&characterEncoding=utf-8&ueSSL=false

      # 查询所有schemata
      databases: >
          SELECT schema_name as schemaName FROM information_schema.schemata

      # 查询指定schema下所有表
      tables: >
        select table_name as tableName, table_comment as tableComment
        from information_schema.tables 
        where table_schema = #{0}

      # 查询指定schema下指定表信息
      tableInfo: > # >表示多行，但忽略换行符
        select table_name as tableName, table_comment as tableComment
        from information_schema.tables 
        where table_schema= #{0} and table_name = #{1}

      # 查询指定schema下指定数据表字段信息
      tableStructure: >
        select column_name as columnName, data_type as columnType,
               column_comment as columnComment, is_nullable as isNullable,
               column_default as columnDefault, character_maximum_length as length,
               column_key as columnKey, extra as extra
        from information_schema.columns 
        where table_schema = #{0} and table_name = #{1}
        order by ordinal_position;

    ######################################### mariadb 数据库 #############################################
    mariadb:
      driverClass: org.mariadb.jdbc.Driver

      url: jdbc:mariadb://${ip}:${port}/${database}?serverTimezone=Asia/Shanghai&useUnicode=true&characterEncoding=utf-8&ueSSL=false

      # 查询所有schemata
      databases: >
        SELECT schema_name as schemaName FROM information_schema.schemata

      # 查询指定schema下所有表
      tables: >
        select table_name as tableName, table_comment as tableComment
        from information_schema.tables 
        where table_schema = #{0}

      # 查询指定schema下指定表信息
      tableInfo: > # >表示多行，但忽略换行符
        select table_name as tableName, table_comment as tableComment
        from information_schema.tables 
        where table_schema= #{0} and table_name = #{1}

      # 查询指定schema下指定数据表字段信息
      tableStructure: >
        select column_name as columnName, data_type as columnType,
               column_comment as columnComment, is_nullable as isNullable,
               column_default as columnDefault, character_maximum_length as length,
               column_key as columnKey, extra as extra
        from information_schema.columns 
        where table_schema = #{0} and table_name = #{1}
        order by ordinal_position;

    ######################################### Oracle数据库 #############################################
    oracle:
      driverClass: oracle.jdbc.OracleDriver

      url: jdbc:oracle:thin:@${ip}:${port}:${database}

      databases: >
        SELECT USERNAME as "schemaName" FROM ALL_USERS

      tables: >
        SELECT comm.TABLE_NAME as "tableName", comm.COMMENTS as "tableComment"
        FROM all_tables tab 
        inner join all_tab_comments comm 
        on tab.OWNER = comm.OWNER and tab.TABLE_NAME = comm.TABLE_NAME 
        WHERE tab.OWNER = #{0}

      tableInfo: >
        SELECT comm.TABLE_NAME as "tableName", comm.COMMENTS as "tableComment"
        FROM all_tables tab 
        inner join all_tab_comments comm 
        on tab.OWNER = comm.OWNER and tab.TABLE_NAME = comm.TABLE_NAME 
        WHERE tab.OWNER = #{0} and tab.TABLE_NAME = #{1}

      tableStructure: >
        SELECT col.COLUMN_NAME as "columnName", col.DATA_TYPE as "columnType",
        comm.COMMENTS as "columnComment", col.NULLABLE as "isNullable",
        col.DATA_DEFAULT as "columnDefault" 
        FROM all_tab_columns col 
        inner join ALL_COL_COMMENTS comm 
        on col.OWNER = comm.OWNER and col.TABLE_NAME = comm.TABLE_NAME 
        WHERE comm.owner = #{0} AND comm.TABLE_NAME = #{1}

    ######################################### DB2数据库 #############################################
    db2:
      driverClass: com.ibm.db2.jcc.DB2Driver

      url: jdbc:db2://${ip}:${port}/${database}

      databases: >
        SELECT SCHEMANAME as "schemaName" FROM SYSCAT.SCHEMATA

      tables: >
        SELECT TABNAME as "tableName", REMARKS as "tableComment"
        FROM SYSCAT.TABLES WHERE TABSCHEMA = #{0}

      tableInfo: >
        SELECT TABNAME as "tableName", REMARKS as "tableComment"
        FROM SYSCAT.TABLES 
        WHERE TABSCHEMA= #{0} AND TABNAME= #{1}

      tableStructure: >
        SELECT COLNAME as "columnName", TYPENAME "columnType",
        REMARKS as "columnComment", NULLS as "isNullable",
        DEFAULT as "columnDefault"
        FROM SYSCAT.COLUMNS 
        WHERE TABSCHEMA= #{0} AND TABNAME= #{0}

    #########################################  Postgresql 数据库 #############################################
    postgresql:

      driverClass: org.postgresql.Driver

      url: jdbc:postgresql://${ip}:${port}/${database}

      databases: >
        SELECT schema_name AS "schemaName" FROM information_schema.schemata;

      tables: >
        SELECT table_name as "tableName", obj_description(pg_class.oid) AS "tableComment"
        FROM information_schema.tables
        JOIN pg_class ON information_schema.tables.table_name = pg_class.relname
        WHERE table_schema = #{0} AND table_type = 'BASE TABLE'

      tableInfo: >
        SELECT table_name as "tableName", obj_description(pg_class.oid) AS "tableComment"
        FROM information_schema.tables
        JOIN pg_class ON information_schema.tables.table_name = pg_class.relname
        WHERE table_schema = #{0} and table_name = #{1} and table_type = 'BASE TABLE'

      tableStructure: >
        SELECT cols.column_name as "columnName", cols.data_type as "columnType",
            cols.column_default as "columnDefault", cols.is_nullable as "isNullable",
            character_maximum_length as length,
            (SELECT pg_catalog.col_description(c.oid, cols.ordinal_position::int)
             FROM pg_catalog.pg_class c
             WHERE c.relname = cols.table_name) AS "columnComment"
        FROM information_schema.columns cols
        WHERE cols.table_schema = #{0} AND cols.table_name = #{1}

    #########################################  sqlserver 数据库 #############################################
    sqlserver:

      driverClass: com.microsoft.sqlserver.jdbc.SQLServerDriver

      url: jdbc:sqlserver://${ip}:${port};DatabaseName=${database}

      databases: >
        SELECT name as schemaName FROM sys.databases

      tables: >
        SELECT t.name AS tableName, ISNULL(ep.value, '') AS tableComment
        FROM ${0}.sys.tables AS t
        LEFT JOIN ${0}.sys.extended_properties AS ep 
        ON ep.major_id = t.object_id AND ep.minor_id = 0 AND ep.class = 1 AND ep.name = 'MS_Description'
        ORDER BY
        tableName;

      tableInfo: >
        SELECT t.name AS tableName,
        m.value AS tableComment
        FROM ${0}.sys.tables t
        LEFT JOIN test.sys.extended_properties m ON t.object_id = m.major_id AND m.minor_id = 0
        WHERE t.name = #{1}

      tableStructure: >
        SELECT col.name AS columnName, tp.name AS columnType, col.max_length AS length,
               CASE WHEN col.default_object_id IS NOT NULL THEN def.definition ELSE NULL END AS columnDefault,
               CASE WHEN col.is_nullable = 1 THEN 'YES' ELSE 'NO' END AS isNullable,
               ep.[value] AS columnComment
        FROM ${0}.sys.columns col
        INNER JOIN ${0}.sys.types tp ON col.user_type_id = tp.user_type_id
        LEFT JOIN ${0}.sys.default_constraints def ON col.default_object_id = def.object_id
        LEFT JOIN ${0}.sys.extended_properties ep ON ep.major_id = col.object_id AND ep.minor_id = 0 AND ep.class = 1 AND ep.name = 'MS_Description'
        INNER JOIN ${0}.sys.tables tbl ON col.object_id = tbl.object_id
        WHERE tbl.name = #{1};

    #########################################  clickhouse 数据库 #############################################
    clickhouse:
      driverClass: ru.yandex.clickhouse.ClickHouseDriver

      url: jdbc:clickhouse://${ip}:${port}

      # 查询所有数据库
      databases: >
        SELECT database as schemaName, comment as schemaComment FROM system.databases

      # 查询指定schema下所有表
      tables: >
        select name as tableName, comment as tableComment
        from system.tables
        where database = #{0}

      # 查询指定schema下指定表信息
      tableInfo: > # >表示多行，但忽略换行符
        select name as tableName, comment as tableComment
        from system.tables
        where database = #{0} and table = #{1};

      # 查询指定schema下指定数据表字段信息
      tableStructure: >
        SELECT column_name as columnName, column_type as columnType, column_default as columnDefault,
               CASE WHEN is_nullable = 1 THEN 'YES' ELSE 'NO' END AS isNullable,
               character_maximum_length as length, column_comment as columnComment
        FROM INFORMATION_SCHEMA.COLUMNS
        WHERE COLUMNS.table_schema = #{0} and table_name = #{1}
